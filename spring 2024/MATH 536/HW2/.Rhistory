g6 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second")
g7 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second")
gr1 <- ggarrange(g1, g2, g3, g4, labels = c('logit','knn','LDA','Naive Bayes'), ncol = 2, nrow = 2)
gr2 <- ggarrange(g5,g6,g7, labels = c('lass', 'ridge', 'fs'), ncol = 2, nrow = 2)
gr3 <- ggarrange(g1, g2, g3, g4,g55,g6,g7,
labels = c('logit','knn','LDA','Naive Bayes','lass', 'ridge', 'fs'),
ncol = 3, nrow = 3)
## ROC CURVES cus why not
g1 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second")
g2 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = knn_prob, event_level = "second")
g3 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second")
g4 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = nb_prob, event_level = "second")
g5 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lasso_prob, event_level = "second")
g6 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second")
g7 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second")
gr1 <- ggarrange(g1, g2, g3, g4, labels = c('logit','knn','LDA','Naive Bayes'), ncol = 2, nrow = 2)
gr2 <- ggarrange(g5,g6,g7, labels = c('lass', 'ridge', 'fs'), ncol = 2, nrow = 2)
gr3 <- ggarrange(g1, g2, g3, g4,g5,g6,g7,
labels = c('logit','knn','LDA','Naive Bayes','lass', 'ridge', 'fs'),
ncol = 3, nrow = 3)
## ROC CURVES cus why not
g1 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second")
g2 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = knn_prob, event_level = "second")
g3 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second")
g4 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = nb_prob, event_level = "second")
g5 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lasso_prob, event_level = "second")
g6 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second")
g7 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second")
gr1 <- ggarrange(g1, g2, g3, g4, labels = c('logit','knn','LDA','Naive Bayes'), ncol = 2, nrow = 2)
gr2 <- ggarrange(g5,g6,g7, labels = c('lass', 'ridge', 'fs'), ncol = 2, nrow = 2)
gr3 <- ggarrange(g1, g2, g3, g4,g5,g6,g7,
labels = c('logit','knn','LDA','Naive Bayes','lass', 'ridge', 'fs'),
ncol = 3, nrow = 3)
## ROC CURVES cus why not
g1 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second")
g2 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = knn_prob, event_level = "second")
g3 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second")
g4 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = nb_prob, event_level = "second")
g5 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lasso_prob, event_level = "second")
g6 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second")
g7 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second")
gr1 <- ggarrange(g1, g2, g3, g4, labels = c('logit','knn','LDA','Naive Bayes'), ncol = 2, nrow = 2)
gr2 <- ggarrange(g5,g6,g7, labels = c('lass', 'ridge', 'fs'), ncol = 2, nrow = 2)
gr3 <- ggarrange(g1, g2, g3, g4,g5,g6,g7,
labels = c('logit','knn','LDA','Naive Bayes','lass', 'ridge', 'fs'),
ncol = 3, nrow = 3)
## ROC CURVES cus why not
g1 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second")
g2 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = knn_prob, event_level = "second")
g3 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second")
g4 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = nb_prob, event_level = "second")
g5 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lasso_prob, event_level = "second")
g6 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second")
g7 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second")
gr1 <- ggarrange(g1, g2, g3, g4, labels = c('logit','knn','LDA','Naive Bayes'), ncol = 2, nrow = 2)
gr2 <- ggarrange(g5,g6,g7, labels = c('lass', 'ridge', 'fs'), ncol = 2, nrow = 2)
gr3 <- ggarrange(g1, g2, g3, g4,g5,g6,g7,
labels = c('logit','knn','LDA','Naive Bayes','lass', 'ridge', 'fs'),
ncol = 3, nrow = 3)
gr3
gr2
View(titanic_train)
View(titanic_train)
## ROC CURVES cus why not
g1 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second")
g2 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = knn_prob, event_level = "second")
g3 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second")
g4 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = nb_prob, event_level = "second")
g5 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lasso_prob, event_level = "second")
g6 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second")
g7 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second")
gr1 <- ggarrange(g1, g2, g3, g4, labels = c('logit','knn','LDA','Naive Bayes'), ncol = 2, nrow = 2)
gr2 <- ggarrange(g5,g6,g7, labels = c('lasso', 'ridge', 'fs'), ncol = 2, nrow = 2)
gr3 <- ggarrange(g1, g2, g3, g4,g5,g6,g7,
labels = c('logit','knn','LDA','Naive Bayes','lass', 'ridge', 'fs'),
ncol = 3, nrow = 3)
gr2
## ROC CURVES cus why not
g1 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second") %>% autoplot()
g2 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = knn_prob, event_level = "second") %>% autoplot()
g3 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second") %>% autoplot()
g4 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = nb_prob, event_level = "second") %>% autoplot()
g5 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lasso_prob, event_level = "second") %>% autoplot()
g6 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second") %>% autoplot()
g7 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second") %>% autoplot()
gr1 <- ggarrange(g1, g2, g3, g4, labels = c('logit','knn','LDA','Naive Bayes'), ncol = 2, nrow = 2)
gr2 <- ggarrange(g5,g6,g7, labels = c('lasso', 'ridge', 'fs'), ncol = 2, nrow = 2)
gr3 <- ggarrange(g1, g2, g3, g4,g5,g6,g7,
labels = c('logit','knn','LDA','Naive Bayes','lass', 'ridge', 'fs'),
ncol = 3, nrow = 3)
gr2
gr3
gr1
gr2
gr3
gr1
gr2
gr3
## ROC CURVES cus why not
g1 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second") %>% autoplot()
g2 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = knn_prob, event_level = "second") %>% autoplot()
g3 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second") %>% autoplot()
g4 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = nb_prob, event_level = "second") %>% autoplot()
g5 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lasso_prob, event_level = "second") %>% autoplot()
g6 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second") %>% autoplot()
g7 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second") %>% autoplot()
gr1 <- ggarrange(g1, g2, g3, g4, labels = c('logit','knn','LDA','Naive Bayes'), ncol = 2, nrow = 2)
gr2 <- ggarrange(g5,g6,g7, labels = c('lasso', 'ridge', 'fs'), ncol = 2, nrow = 2)
gr3 <- ggarrange(g1, g2, g3, g4,g5,g6,g7,
labels = c('logit','knn','LDA','Naive Bayes','lasso', 'ridge', 'fs'),
ncol = 3, nrow = 3)
gr1
gr2
gr3
## ROC CURVES cus why not
g1 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second") %>% autoplot()
g2 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = knn_prob, event_level = "second") %>% autoplot()
g3 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second") %>% autoplot()
g4 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = nb_prob, event_level = "second") %>% autoplot()
g5 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lasso_prob, event_level = "second") %>% autoplot()
g6 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second") %>% autoplot()
g7 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second") %>% autoplot()
gr1 <- ggarrange(g1, g2, g3, g4, labels = c('1.','2.','3.','4.'), ncol = 2, nrow = 2)
gr2 <- ggarrange(g5,g6,g7, labels = c('5.', '6.', '7.'), ncol = 2, nrow = 2)
gr3 <- ggarrange(g1, g2, g3, g4,g5,g6,g7,
labels = c('1.','2.','3.','4.','5.', '6.', '7.'),
ncol = 3, nrow = 3)
## ROC CURVES cus why not
g1 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second") %>% autoplot()
g2 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = knn_prob, event_level = "second") %>% autoplot()
g3 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second") %>% autoplot()
g4 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = nb_prob, event_level = "second") %>% autoplot()
g5 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = lasso_prob, event_level = "second") %>% autoplot()
g6 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second") %>% autoplot()
g7 <- titanic_train %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second") %>% autoplot()
gr1 <- ggarrange(g1, g2, g3, g4, labels = c('1.','2.','3.','4.'), ncol = 2, nrow = 2)
gr2 <- ggarrange(g5,g6,g7, labels = c('5.', '6.', '7.'), ncol = 2, nrow = 2)
gr3 <- ggarrange(g1, g2, g3, g4,g5,g6,g7,
labels = c('1.','2.','3.','4.','5.', '6.', '7.'),
ncol = 3, nrow = 3)
gr1
gr2
gr3
g1 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second") %>%
autoplot()
g2 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second") %>%
autoplot()
g3 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second") %>%
autoplot()
g4 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second") %>%
autoplot()
fig1 <- ggarrange(g1,g2,g3,g4,
labels = c('F.S.','LDA','Logistic', 'Ridge'),
nrow = 2, ncol = 2)
fig1
g1 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second") %>%
autoplot()
g2 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second") %>%
autoplot()
g3 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second") %>%
autoplot()
g4 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second") %>%
autoplot()
fig1 <- ggarrange(g1,g2,g3,g4,
labels = c('F.S.','LDA','Logistic     ', 'Ridge'),
nrow = 2, ncol = 2)
fig1
g1 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second") %>%
autoplot()
g2 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second") %>%
autoplot()
g3 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second") %>%
autoplot()
g4 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second") %>%
autoplot()
fig1 <- ggarrange(g1,g2,g3,g4,
labels = c('F.S.','LDA','     Logistic', 'Ridge'),
nrow = 2, ncol = 2)
fig1
g1 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second") %>%
autoplot()
g2 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second") %>%
autoplot()
g3 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second") %>%
autoplot()
g4 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second") %>%
autoplot()
fig1 <- ggarrange(g1,g2,g3,g4,
labels = c('F.S.','LDA','Logistic      ', 'Ridge'),
nrow = 2, ncol = 2)
fig1
g1 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second") %>%
autoplot()
g2 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second") %>%
autoplot()
g3 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second") %>%
autoplot()
g4 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second") %>%
autoplot()
fig1 <- ggarrange(g1,g2,g3,g4,
labels = c('F.S.','LDA','Logistic', 'Ridge'),
nrow = 2, ncol = 2)
fig1
g1 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second") %>%
autoplot()
g2 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second") %>%
autoplot()
g3 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second") %>%
autoplot()
g4 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second") %>%
autoplot()
fig1 <- ggarrange(g1,g2,g3,g4,
labels = c('F.S.','LDA','Log.', 'Ridge'),
nrow = 2, ncol = 2)
fig1
g1 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = fs_prob, event_level = "second") %>%
autoplot()
g2 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = lda_prob, event_level = "second") %>%
autoplot()
g3 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = logit_prob, event_level = "second") %>%
autoplot()
g4 <- titanic %>%
filter(train == TRUE) %>%
roc_curve(truth =  Survived, estimate = ridge_prob, event_level = "second") %>%
autoplot()
fig1 <- ggarrange(g1,g2,g3,g4,
labels = c('F.S.','LDA','GLM', 'Ridge'),
nrow = 2, ncol = 2)
fig1
power <- function(teta, teta0, n, sigma = 1, zstar){
p = 1 - pnorm(q = (teta0-teta)*sqrt(n)/sigma + zstar) + pnorm(q = (teta0-teta)*sqrt(n)/sigma - zstar)
p
}
pow1 <- power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96)
curve(pow1, 0.5, 1.5, add = TRUE, col = 'red')
power <- function(teta, teta0, n, sigma = 1, zstar){
p = 1 - pnorm(q = (teta0-teta)*sqrt(n)/sigma + zstar) + pnorm(q = (teta0-teta)*sqrt(n)/sigma - zstar)
p
}
pow1 <- power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96)
curve(pow1, 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
curve(power(teta = 1, teta0 = 1, n = 20, sigma = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
pow <- function(teta, teta_0, n, sig = 1, zstar) {
right_bound <- pnorm(q = (teta_0 - teta) * sqrt(n) / sig + zstar)
left_bound <- pnorm(q = (teta_0 - teta) * sqrt(n) / sig - zstar)
p <- 1 - right_bound + left_bound
return(p)
}
curve(pow(teta = 1, teta_0 = 1, n = 20, sig = 1, zstar = 1.96), 0.5, 1.5, add = TRUE, col = 'red')
power <- function(teta, teta0, n, sigma = 1, zstar){
beta = 1 - pnorm(q = (teta0-teta)*sqrt(n)/sigma + zstar) +  pnorm(q = (teta0-teta)*sqrt(n)/sigma - zstar)
beta
}
power(teta = 1.5, teta0 = 1, n= 20, sigma =1, zstar = 1.96)
curve(power(teta = x, teta0 = 1, n= 20, sigma =1, zstar = 1.96), 0.5,1.5)
curve(power(teta = x, teta0 = 1, n= 10, sigma =1, zstar = 1.96)
, 0.5,1.5, add = TRUE, col = "red")
power <- function(teta, teta0, n, sigma = 1, zstar){
beta = 1 - pnorm(q = (teta0-teta)*sqrt(n)/sigma + zstar) +  pnorm(q = (teta0-teta)*sqrt(n)/sigma - zstar)
beta
}
power(teta = 1.5, teta0 = 1, n= 20, sigma =1, zstar = 1.96)
#curve(power(teta = x, teta0 = 1, n= 20, sigma =1, zstar = 1.96), 0.5,1.5)
curve(power(teta = x, teta0 = 1, n= 10, sigma =1, zstar = 1.96)
, 0.5,1.5, add = TRUE, col = "red")
power <- function(teta, teta0, n, sigma = 1, zstar){
beta = 1 - pnorm(q = (teta0-teta)*sqrt(n)/sigma + zstar) +  pnorm(q = (teta0-teta)*sqrt(n)/sigma - zstar)
beta
}
power(teta = 1.5, teta0 = 1, n= 20, sigma =1, zstar = 1.96)
#curve(power(teta = x, teta0 = 1, n= 20, sigma =1, zstar = 1.96), 0.5,1.5)
curve(power(teta = x, teta0 = 1, n= 10, sigma =1, zstar = 1.96)
, 0.5,1.5, add = TRUE, col = "red")
power <- function(teta, teta0, n, sigma = 1, zstar){
beta = 1 - pnorm(q = (teta0-teta)*sqrt(n)/sigma + zstar) +  pnorm(q = (teta0-teta)*sqrt(n)/sigma - zstar)
beta
}
power(teta = 1.5, teta0 = 1, n= 20, sigma =1, zstar = 1.96)
#curve(power(teta = x, teta0 = 1, n= 20, sigma =1, zstar = 1.96), 0.5,1.5)
curve(power(teta = x, teta0 = 1, n= 10, sigma =1, zstar = 1.96)
, 0.5,1.5, add = TRUE, col = "red")
pchisq(?)
curve(?)
0.05/2
1-0.025
a <- c(qchisq(0.025,20),qchisq(0.975,20))
a
a <- c(qchisq(0.025,19),qchisq(0.975,19))
a
ln(e)
ln(exp())
library(TeachingDemos)
hpd(rgamma(20, shape = 10.5, rate = 0.1), prob = .95)
qgamma(.975,20,scale = 2)
setwd("~/Desktop/githubbahubba/CSUF/spring 2024/MATH 536/HW2")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Desktop/githubbahubba/CSUF/spring 2024/MATH 536/HW2")
# import the data
data <-  read.csv("data.csv")
View(data)
# get metrics
x.bar <-  mean(data)
?cor()
# get metrics
xbar <-  mean(data$Spend)
ybar <- mean(data$Revenue)
sx <- sd(data$Spend)
sy <- sd(data$Revenue)
r <- cor(data$Spend,data$Revenue)
n <- nrow(data)
# doing the algebra
m = r*sy/sx
b = ybar - m*xbar
yhat = m*(data$Spend) + b
# noise/error
err <- data$Revenue - yhat
# other stuff
s.err <- sqrt(sum(err^2)/(n-2))
SXX = var(data$Spend)*(n-1)
se.b = s.err/sqrt(SXX)
se.a = s.err/sqrt(1/n + xbar^2/SXX)
b
a
# other stuff
s.err <- sqrt(sum(err^2)/(n-2))
SXX = var(data$Spend)*(n-1)
se.b = s.err/sqrt(SXX)
se.a = s.err/sqrt(1/n + xbar^2/SXX)
r^2
se.b
se.a
s.err
plot(data$Revenue ~ data$Spend)
model1 <- lm(Revenue ~ Spend, data=data )
model1
# summary
summary(model1)
# visualization
plot(Revenue ~ Spend,data = data)
abline(model1)
# visualization
plot(Revenue ~ Spend,data = data, main = "Revenue vs. Spend")
abline(model1)
model1 = lm(Revenue ~ Spend, data=data )
abline(model1)
abline(lm(Revenue ~ Spend, data=data ))
abline(lm(Revenue ~ Spend, data=data))
abline(model1)
# visualization
plot(Revenue ~ Spend,data = data, main = "Revenue vs. Spend")
abline(model1)
# predictions
newdata.5 = data.frame(Spend = 500000)
newdata.7 = data.frame(Spend = 700000)
# predictions
newdata.5 = data.frame(Spend = 500000)
predict(model1,newdata.5,interval="predict")
predict(model1,newdata.5,interval="confidence")
newdata.7 = data.frame(Spend = 700000)
predict(model1,newdata.5,interval="predict")
predict(model1,newdata.5,interval="confidence")
# predictions
newdata.5 = data.frame(Spend = 500000)
predict(model1,newdata.5,interval="predict")
newdata.7 = data.frame(Spend = 700000)
predict(model1,newdata.5,interval="predict")
# predictions
newdata.5 = data.frame(Spend = 500000)
predict(model1,newdata.5,interval="predict")
newdata.7 = data.frame(Spend = 700000)
predict(model1,newdata.7,interval="predict")
# let's look at cost effectiveness
# if we spend 500k$
457082.9 - 500000
963839.2 - 500000
# if we spend 700k$
607819 - 700000
1114337 - 700000
463839.2 - 414337
92181 - 42917.1
